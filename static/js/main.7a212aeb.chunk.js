(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{31:function(e,t,a){"use strict";(function(e){var n=a(2),c=a.n(n),r=a(17),l=a(6),o=a(4),s=a(0),i=a.n(s),u=a(7),m=a(9),d=a(1),b=a(13),f=a.n(b).a.BigInt;t.a=function(){var t=Object(s.useState)("https://testnet.perlin.net"),a=Object(o.a)(t,2),n=a[0],b=a[1],p=Object(s.useState)(e.from(u.Wavelet.generateNewWallet().secretKey,"binary").toString("hex")),x=Object(o.a)(p,2),h=x[0],E=x[1],v=Object(s.useState)(void 0),g=Object(o.a)(v,2),y=g[0],w=g[1],j=Object(s.useState)(void 0),O=Object(o.a)(j,2),k=O[0],B=O[1],_=Object(s.useState)("abfbe62a90d663d983f9c5b65b67d5acabf05f5ce8ede0181fe9924265a52aad"),W=Object(o.a)(_,2),F=W[0],S=W[1],P=Object(s.useState)(void 0),C=Object(o.a)(P,2),I=C[0],A=C[1],N=Object(s.useState)(""),R=Object(o.a)(N,2),K=R[0],L=R[1],D=Object(s.useState)([]),J=Object(o.a)(D,2),M=J[0],z=J[1],U=Object(s.useState)(void 0),H=Object(o.a)(U,2),Y=H[0],$=H[1],q=Object(s.useState)(void 0),G=Object(o.a)(q,2),Q=G[0],T=G[1],V=Object(s.useRef)(Y),X=Object(s.useRef)(Q);Object(s.useEffect)(function(){V.current=Y},[Y]),Object(s.useEffect)(function(){X.current=Q},[Q]);var Z=Object(s.useState)({accounts:void 0,contract:void 0,consensus:void 0}),ee=Object(o.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(s.useRef)(te);Object(s.useEffect)(function(){ne.current=te},[te]);var ce=function(){w(void 0),$(void 0),T(void 0),B(void 0),A(void 0),S(""),L(""),z([]);var e=ne.current;e.accounts&&e.accounts.close(1e3,"connection closing normally"),e.contract&&e.contract.close(1e3,"connection closing normally"),e.consensus&&e.consensus.close(1e3,"connection closing normally"),ae({accounts:void 0,consensus:void 0})},re=function(){var t=Object(l.a)(c.a.mark(function t(){var a,l,o;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==y){t.next=28;break}return t.prev=1,a=new u.Wavelet(n),t.t0=B,t.next=6,a.getNodeInfo();case 6:return t.t1=t.sent,(0,t.t0)(t.t1),l=u.Wavelet.loadWalletFromPrivateKey(h),o=e.from(l.publicKey).toString("hex"),t.t2=$,t.next=13,a.getAccount(o);case 13:return t.t3=t.sent,(0,t.t2)(t.t3),w(a),t.next=18,a.pollAccounts({onAccountUpdated:function(e){switch(e.event){case"balance_updated":$(Object(r.a)({},V.current,{balance:e.balance}))}}},{id:o});case 18:te.accounts=t.sent,ae(te),t.next=26;break;case 22:t.prev=22,t.t4=t.catch(1),ce(),alert(t.t4);case 26:t.next=29;break;case 28:ce();case 29:case"end":return t.stop()}},t,null,[[1,22]])}));return function(){return t.apply(this,arguments)}}(),le=function(){var e=Object(l.a)(c.a.mark(function e(){var t,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=T,e.next=3,y.getAccount(F);case 3:return e.t1=e.sent,(0,e.t0)(e.t1),t=new u.Contract(y,F),e.next=8,t.init();case 8:return a=u.Wavelet.loadWalletFromPrivateKey(h),e.next=11,y.pollConsensus({onRoundEnded:function(e){void 0!==t&&Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchAndPopulateMemoryPages();case 2:z(t.test(a,"get_messages",f(0)).logs);case 3:case"end":return e.stop()}},e)}))()}});case 11:return te.consensus=e.sent,e.next=14,y.pollAccounts({onAccountUpdated:function(e){switch(e.event){case"gas_balance_updated":T(Object(r.a)({},X.current,{gas_balance:e.gas_balance}))}}},{id:F});case 14:te.contract=e.sent,ae(te),z(t.test(a,"get_messages",f(0)).logs),A(t);case 18:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.Wavelet.loadWalletFromPrivateKey(h),e.next=3,I.call(t,"send_message",f(0),f(25e4),f(0),{type:"string",value:K});case 3:L("");case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return i.a.createElement(i.a.Fragment,null,i.a.createElement("h2",{className:"text-center title"},"A decentralized chat written in JavaScript + Rust (WebAssembly)."),i.a.createElement(d.Box,{className:"text-center",mb:4},"Powered by ",i.a.createElement("a",{href:"https://wavelet.perlin.net"},"Wavelet"),". Click"," ",i.a.createElement("a",{href:"https://medium.com/perlin-network/build-a-decentralized-chat-using-javascript-rust-webassembly-c775f8484b52"},"here")," to learn how it works, and"," ",i.a.createElement("a",{href:"https://github.com/perlin-network/decentralized-chat"},"here")," ","for the source code. Join our"," ",i.a.createElement("a",{href:"https://discord.gg/dMYfDPM"},"Discord")," to get PERLs."),i.a.createElement(d.Flex,{mb:2,alignItems:"center"},i.a.createElement(d.Box,{flex:"0 0 150px"},i.a.createElement("label",null,"[secret]")),i.a.createElement(d.Box,{flex:"1"},i.a.createElement("input",{type:"text",value:h,disabled:y,"data-lpignore":"true",onChange:function(e){return E(e.target.value)}}))),i.a.createElement(d.Flex,{mb:2,alignItems:"center"},i.a.createElement(d.Box,{flex:"0 0 150px"},i.a.createElement("label",null,"[node]")),i.a.createElement(d.Box,{flex:"1"},i.a.createElement(d.Flex,{width:1},i.a.createElement(d.Box,{width:.75},i.a.createElement("input",{type:"text",value:n,disabled:y,"data-lpignore":"true",onKeyPress:function(){var e=Object(l.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key){e.next=3;break}return e.next=3,re();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),onChange:function(e){return b(e.target.value)}})),i.a.createElement(d.Box,{width:.25,style:{minWidth:"10em"},ml:2},i.a.createElement("button",{style:{width:"100%"},onClick:re,disabled:128!==h.length},y?"Disconnect":"Connect"))))),i.a.createElement(d.Flex,{mb:4,alignItems:"center"},i.a.createElement(d.Box,{flex:"0 0 150px"},i.a.createElement("label",null,"[contract]")),i.a.createElement(d.Box,{flex:"1"},i.a.createElement(d.Flex,{width:1},i.a.createElement(d.Box,{width:.75},i.a.createElement("input",{type:"text",value:F,placeholder:"input chat smart contract address...",disabled:!y,"data-lpignore":"true",onKeyPress:function(){var e=Object(l.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key){e.next=3;break}return e.next=3,le();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),onChange:function(e){return S(e.target.value)}})),i.a.createElement(d.Box,{width:.25,style:{minWidth:"10em"},ml:2},i.a.createElement("button",{style:{width:"100%"},disabled:!y||64!==F.length,onClick:le},"Load Contract"))))),i.a.createElement(m.FaucetButton,{modalHeader:!0,theme:m.themes.mono,style:{position:"fixed",right:"100px",bottom:"0px"},address:Y&&Y.public_key}),i.a.createElement(d.Flex,{mb:2,alignItems:"center"},i.a.createElement(d.Box,{flex:"0 0 150px"},i.a.createElement("label",null,"[node id]")),i.a.createElement(d.Box,{flex:"1",style:{minWidth:0}},i.a.createElement("span",{className:"truncate",title:"".concat(k&&k.public_key?k.public_key:"???")},"".concat(k&&k.public_key?k.public_key:"???")))),i.a.createElement(d.Flex,{mb:2,alignItems:"center"},i.a.createElement(d.Box,{flex:"0 0 150px"},i.a.createElement("label",null,"[your id]")),i.a.createElement(d.Box,{flex:"1",style:{minWidth:0}},i.a.createElement("span",{className:"truncate",title:"".concat(Y&&Y.public_key?Y.public_key:"???")},"".concat(Y&&Y.public_key?Y.public_key:"???")))),i.a.createElement(d.Flex,{mb:2,alignItems:"center"},i.a.createElement(d.Box,{flex:"0 0 150px"},i.a.createElement("label",null,"[your balance]")),i.a.createElement(d.Box,{flex:"1"},i.a.createElement("span",null,"".concat(Y&&Y.balance?Y.balance:0," PERL(s)")))),i.a.createElement(d.Flex,{mb:4,alignItems:"center"},i.a.createElement(d.Box,{flex:"0 0 150px"},i.a.createElement("label",null,"[contract gas balance]")),i.a.createElement(d.Box,{flex:"1"},i.a.createElement("span",null,"".concat(Q&&Q.gas_balance?Q.gas_balance:0," PERL(s)")))),i.a.createElement(d.Flex,{mb:3},i.a.createElement(d.Box,{flex:"1",pr:2},i.a.createElement("textarea",{disabled:!y||!I,value:K,placeholder:"enter a message...",maxLength:240,onKeyPress:function(e){"Enter"===e.key&&(Y.balance>2&&Q.gas_balance+Y.balance>=25e4&&K.length>0&&K.length<=240?oe():e.preventDefault())},onChange:function(e){return L(e.target.value)},className:"fw"})),i.a.createElement(d.Box,{flex:"0 0 220px"},i.a.createElement("button",{className:"fw",style:{height:"98%"},disabled:!y||!I||!Y||Y.balance<2||Q.gas_balance+Y.balance<25e4||0===K.length,onClick:oe},"Send Message [2 PERLs]"))),i.a.createElement("textarea",{disabled:!y||!I,className:"fw",rows:35,readOnly:!0,placeholder:"no messages here so far chief...",value:1===M.length?M[0]:""}))}}).call(this,a(10).Buffer)},36:function(e,t,a){e.exports=a(94)},41:function(e,t,a){},65:function(e,t){},94:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(30),l=a.n(r),o=(a(41),a(31));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement(o.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[36,1,2]]]);
//# sourceMappingURL=main.7a212aeb.chunk.js.map